The sanitizer detected a heap buffer overflow vulnerability. The explanation of the vulnerability is: The program tried to access a heap object outside of its allocated memory, causing potential memory corruption or crashes. Here is the detail: 

READ of size 1 at 0x503000000b34 thread T0
    - __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:63:3
    - WebPDataCopy /src/libwebp/src/webp/mux_types.h:89:5
    - ChunkAssignData /src/libwebp/src/mux/muxinternal.c:128:12
    - ChunkVerifyAndAssign /src/libwebp/src/mux/muxread.c:76:10
    - WebPMuxCreateInternal /src/libwebp/src/mux/muxread.c:245:9
    - WebPMuxCreate(WebPData const*, int) /src/libwebp/src/webp/mux.h:142:10
    - (anonymous namespace)::MuxDemuxApiTest(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool) /src/libwebp/tests/fuzzer/mux_demux_api_fuzzer.cc:39:20
    - auto fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)::operator()<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, bool&>(auto&&...) const /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/fixture_driver.h:294:11
    - decltype(std::declval<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)>()(std::declval<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&>(), std::declval<bool&>())) std::__1::__invoke[abi:ne180100]<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...), std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, bool&>(fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, bool&) /usr/local/include/c++/v1/__type_traits/invoke.h:344:25
    - decltype(auto) std::__1::__apply_tuple_impl[abi:ne180100]<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...), std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&, 0ul, 1ul>(fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)&&, std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&, std::__1::__tuple_indices<0ul, 1ul>) /usr/local/include/c++/v1/tuple:1424:5
    - decltype(auto) std::__1::apply[abi:ne180100]<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...), std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&>(fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)&&, std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&) /usr/local/include/c++/v1/tuple:1428:5
    - fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/fixture_driver.h:292:5
    - fuzztest::internal::FuzzTestFuzzerImpl::RunOneInput(fuzztest::internal::FuzzTestFuzzerImpl::Input const&) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/runtime.cc:927:20
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunOneInputData(std::__1::basic_string_view<char, std::__1::char_traits<char>>) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:131:8
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunInFuzzingMode(int*, char***, fuzztest::internal::Configuration const&)::$_1::operator()(unsigned char const*, unsigned long) const /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:93:34
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunInFuzzingMode(int*, char***, fuzztest::internal::Configuration const&)::$_1::__invoke(unsigned char const*, unsigned long) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:92:35
    - fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    - fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    - fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunInFuzzingMode(int*, char***, fuzztest::internal::Configuration const&) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:92:3
    - fuzztest::internal::GTest_TestAdaptor::TestBody() /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/googletest_adaptor.h:83:7
    - void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2612:10
    - void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2648:14
    - testing::Test::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2687:5
    - testing::TestInfo::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2836:11
    - testing::TestSuite::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:3015:30
    - testing::internal::UnitTestImpl::RunAllTests() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:5920:44
    - bool testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2612:10
    - bool testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2648:14
    - testing::UnitTest::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:5484:10
    - RUN_ALL_TESTS() /src/libwebp/build/_deps/googletest-src/googletest/include/gtest/gtest.h:2317:73
    - main /src/libwebp/build/_deps/fuzztest-src/fuzztest/fuzztest_gtest_main.cc:28:10

0x503000000b34 is located 0 bytes after 20-byte region [0x503000000b20,0x503000000b34)
allocated by thread T0 here:
    - operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:86:3
    - void* std::__1::__libcpp_operator_new[abi:ne180100]<unsigned long>(unsigned long) /usr/local/include/c++/v1/new:271:10
    - std::__1::__libcpp_allocate[abi:ne180100](unsigned long, unsigned long) /usr/local/include/c++/v1/new:295:10
    - std::__1::allocator<char>::allocate[abi:ne180100](unsigned long) /usr/local/include/c++/v1/__memory/allocator.h:125:32
    - std::__1::__allocation_result<std::__1::allocator_traits<std::__1::allocator<char>>::pointer> std::__1::__allocate_at_least[abi:ne180100]<std::__1::allocator<char>>(std::__1::allocator<char>&, unsigned long) /usr/local/include/c++/v1/__memory/allocate_at_least.h:55:19
    - std::__1::vector<char, std::__1::allocator<char>>::__vallocate[abi:ne180100](unsigned long) /usr/local/include/c++/v1/vector:741:25
    - void std::__1::vector<char, std::__1::allocator<char>>::__init_with_size[abi:ne180100]<std::__1::__wrap_iter<char*>, std::__1::__wrap_iter<char*>>(std::__1::__wrap_iter<char*>, std::__1::__wrap_iter<char*>, unsigned long) /usr/local/include/c++/v1/vector:759:7
    - std::__1::vector<char, std::__1::allocator<char>>::vector<std::__1::__wrap_iter<char*>, 0>(std::__1::__wrap_iter<char*>, std::__1::__wrap_iter<char*>) /usr/local/include/c++/v1/vector:1177:3
    - decltype(auto) fuzztest::internal::ForceVectorForStringView<std::__1::basic_string_view<char, std::__1::char_traits<char>>, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&&) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/fixture_driver.h:186:24
    - auto fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)::operator()<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, bool&>(auto&&...) const /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/fixture_driver.h:294:28
    - decltype(std::declval<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)>()(std::declval<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&>(), std::declval<bool&>())) std::__1::__invoke[abi:ne180100]<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...), std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, bool&>(fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, bool&) /usr/local/include/c++/v1/__type_traits/invoke.h:344:25
    - decltype(auto) std::__1::__apply_tuple_impl[abi:ne180100]<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...), std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&, 0ul, 1ul>(fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)&&, std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&, std::__1::__tuple_indices<0ul, 1ul>) /usr/local/include/c++/v1/tuple:1424:5
    - decltype(auto) std::__1::apply[abi:ne180100]<fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...), std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&>(fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const::'lambda'(auto&&...)&&, std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>&) /usr/local/include/c++/v1/tuple:1428:5
    - fuzztest::internal::FixtureDriver<fuzztest::Domain<std::__1::tuple<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, bool>>, fuzztest::internal::NoFixture, void (*)(std::__1::basic_string_view<char, std::__1::char_traits<char>>, bool), void*>::Test(fuzztest::internal::MoveOnlyAny&&) const /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/fixture_driver.h:292:5
    - fuzztest::internal::FuzzTestFuzzerImpl::RunOneInput(fuzztest::internal::FuzzTestFuzzerImpl::Input const&) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/runtime.cc:927:20
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunOneInputData(std::__1::basic_string_view<char, std::__1::char_traits<char>>) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:131:8
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunInFuzzingMode(int*, char***, fuzztest::internal::Configuration const&)::$_1::operator()(unsigned char const*, unsigned long) const /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:93:34
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunInFuzzingMode(int*, char***, fuzztest::internal::Configuration const&)::$_1::__invoke(unsigned char const*, unsigned long) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:92:35
    - fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    - fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    - fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    - fuzztest::internal::FuzzTestExternalEngineAdaptor::RunInFuzzingMode(int*, char***, fuzztest::internal::Configuration const&) /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/compatibility_mode.cc:92:3
    - fuzztest::internal::GTest_TestAdaptor::TestBody() /src/libwebp/build/_deps/fuzztest-src/fuzztest/internal/googletest_adaptor.h:83:7
    - void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2612:10
    - void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2648:14
    - testing::Test::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2687:5
    - testing::TestInfo::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2836:11
    - testing::TestSuite::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:3015:30
    - testing::internal::UnitTestImpl::RunAllTests() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:5920:44
    - bool testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2612:10
    - bool testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:2648:14
    - testing::UnitTest::Run() /src/libwebp/build/_deps/googletest-src/googletest/src/gtest.cc:5484:10
    - RUN_ALL_TESTS() /src/libwebp/build/_deps/googletest-src/googletest/include/gtest/gtest.h:2317:73
    - main /src/libwebp/build/_deps/fuzztest-src/fuzztest/fuzztest_gtest_main.cc:28:10


To fix this issue, follow the advice below:

1. If overflow is unavoidable, allocate a sufficiently large buffer during initialization.
2. Add explicit bounds checking before accessing arrays or buffers to prevent overflows.
3. Replace unsafe functions like memcpy, strcpy, strcat, and sprintf with safer alternatives such as strncpy, strncat, and snprintf.
4. Check for integer overflows in size calculations that could cause improper memory allocations.
