INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /mnt/data0/zf1025/AICC/oss-fuzz/build/out/libvips:/out -v /mnt/data0/zf1025/AICC/oss-patch-build/libvips/OSV-2025-6/poc.bin:/testcase -t gcr.io/oss-fuzz-base/base-runner reproduce matrixsave_buffer_fuzzer -runs=100.
+ FUZZER=matrixsave_buffer_fuzzer
+ shift
+ '[' '!' -v TESTCASE ']'
+ TESTCASE=/testcase
+ '[' '!' -f /testcase ']'
+ export RUN_FUZZER_MODE=interactive
+ RUN_FUZZER_MODE=interactive
+ export FUZZING_ENGINE=libfuzzer
+ FUZZING_ENGINE=libfuzzer
+ export SKIP_SEED_CORPUS=1
+ SKIP_SEED_CORPUS=1
+ run_fuzzer matrixsave_buffer_fuzzer -runs=100 /testcase
vm.mmap_rnd_bits = 28
/out/matrixsave_buffer_fuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 740074437
INFO: Loaded 1 modules   (198400 inline 8-bit counters): 198400 [0x55874e6af898, 0x55874e6dff98), 
INFO: Loaded 1 PC tables (198400 PCs): 198400 [0x55874e6dff98,0x55874e9e6f98), 
/out/matrixsave_buffer_fuzzer: Running 1 inputs 100 time(s) each.
Running: /testcase

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.638[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.642[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.642[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.642[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.642[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.645[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.645[0m: Invalid TIFF directory; tags are not sorted in ascending order

(process:14): tiff2vips-[1;33mWARNING[0m **: [34m19:16:07.646[0m: Invalid TIFF directory; tags are not sorted in ascending order
=================================================================
[1m[31m==14==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fc8846b5800 at pc 0x55874cd9271e bp 0x7fc884eb4240 sp 0x7fc884eb4238
[1m[0m[1m[34mREAD of size 1 at 0x7fc8846b5800 thread T4 (libvips worker)[1m[0m
SCARINESS: 12 (1-byte-read-heap-buffer-overflow)
    #0 0x55874cd9271d in next_marker /src/libjpeg-turbo/src/jdmarker.c
    #1 0x55874cd93301 in read_markers /src/libjpeg-turbo/src/jdmarker.c:979:14
    #2 0x55874cd8ebe7 in consume_markers /src/libjpeg-turbo/src/jdinput.c:339:9
    #3 0x55874cd8d55f in jpeg_consume_input /src/libjpeg-turbo/src/jdapimin.c:327:15
    #4 0x55874cd8d2c0 in jpeg_read_header /src/libjpeg-turbo/src/jdapimin.c:275:13
    #5 0x55874c932be7 in rtiff_decompress_jpeg_run /src/libvips/build/../libvips/foreign/tiff2vips.c:2100:6
    #6 0x55874c932be7 in rtiff_decompress_jpeg /src/libvips/build/../libvips/foreign/tiff2vips.c:2203:7
    #7 0x55874c9322db in rtiff_decompress_tile /src/libvips/build/../libvips/foreign/tiff2vips.c:2245:7
    #8 0x55874c9322db in rtiff_read_tile /src/libvips/build/../libvips/foreign/tiff2vips.c:2329:7
    #9 0x55874c931861 in rtiff_fill_region_unaligned /src/libvips/build/../libvips/foreign/tiff2vips.c:2438:8
    #10 0x55874c930c4d in rtiff_fill_region /src/libvips/build/../libvips/foreign/tiff2vips.c:2542:6
    #11 0x55874c5f08a6 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #12 0x55874c5f08a6 in vips_region_prepare_to_generate /src/libvips/build/../libvips/iofuncs/region.c:1748:6
    #13 0x55874c5f03c1 in vips_region_prepare_to /src/libvips/build/../libvips/iofuncs/region.c:1865:7
    #14 0x55874c7c7630 in vips_tile_cache_gen /src/libvips/build/../libvips/conversion/tilecache.c:683:15
    #15 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #16 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #17 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #18 0x55874c5bc066 in vips_image_write_gen /src/libvips/build/../libvips/iofuncs/image.c:2606:6
    #19 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #20 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #21 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #22 0x55874c68c1e6 in vips_foreign_load_generate /src/libvips/build/../libvips/foreign/foreign.c:1066:6
    #23 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #24 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #25 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #26 0x55874c7e23d6 in vips_copy_gen /src/libvips/build/../libvips/conversion/copy.c:140:6
    #27 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #28 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #29 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #30 0x55874c7f424c in vips_cast_gen /src/libvips/build/../libvips/conversion/cast.c:369:6
    #31 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #32 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #33 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #34 0x55874c7e23d6 in vips_copy_gen /src/libvips/build/../libvips/conversion/copy.c:140:6
    #35 0x55874c5f08a6 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #36 0x55874c5f08a6 in vips_region_prepare_to_generate /src/libvips/build/../libvips/iofuncs/region.c:1748:6
    #37 0x55874c5f03c1 in vips_region_prepare_to /src/libvips/build/../libvips/iofuncs/region.c:1865:7
    #38 0x55874c5cc772 in wbuffer_work_fn /src/libvips/build/../libvips/iofuncs/sinkdisc.c:431:11
    #39 0x55874c8c9c9e in vips_worker_work_unit /src/libvips/build/../libvips/iofuncs/threadpool.c:373:6
    #40 0x55874c8c9c9e in vips_thread_main_loop /src/libvips/build/../libvips/iofuncs/threadpool.c:400:3
    #41 0x55874c974d2c in vips_threadset_work /src/libvips/build/../libvips/iofuncs/threadset.c:182:3
    #42 0x55874c5b3f40 in vips_thread_run /src/libvips/build/../libvips/iofuncs/thread.c:148:11
    #43 0x55874c9a3550 in g_thread_proxy (/out/matrixsave_buffer_fuzzer+0xbc8550)
    #44 0x55874c571b88 in asan_thread_start(void*) /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:239:28
    #45 0x7fc88a2ca608 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x8608) (BuildId: 5cfb896dd40f90aa8c6c8bb856004d1f5cfe293c)
    #46 0x7fc88a1ac352 in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x11f352) (BuildId: 0323ab4806bee6f846d9ad4bccfc29afdca49a58)

DEDUP_TOKEN: next_marker--read_markers--consume_markers
[1m[32m0x7fc8846b5800 is located 0 bytes after 524288-byte region [0x7fc884635800,0x7fc8846b5800)
[1m[0m[1m[35mallocated by thread T4 (libvips worker) here:[1m[0m
    #0 0x55874c574219 in calloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:75:3
    #1 0x55874c98b780 in g_malloc0 (/out/matrixsave_buffer_fuzzer+0xbb0780)
    #2 0x55874c930910 in rtiff_seq_start /src/libvips/build/../libvips/foreign/tiff2vips.c:1976:31
    #3 0x55874c5dc120 in vips__region_start /src/libvips/build/../libvips/iofuncs/region.c:238:17
    #4 0x55874c5f07c7 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1618:6
    #5 0x55874c5f07c7 in vips_region_prepare_to_generate /src/libvips/build/../libvips/iofuncs/region.c:1748:6
    #6 0x55874c5f03c1 in vips_region_prepare_to /src/libvips/build/../libvips/iofuncs/region.c:1865:7
    #7 0x55874c7c7630 in vips_tile_cache_gen /src/libvips/build/../libvips/conversion/tilecache.c:683:15
    #8 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #9 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #10 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #11 0x55874c5bc066 in vips_image_write_gen /src/libvips/build/../libvips/iofuncs/image.c:2606:6
    #12 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #13 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #14 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #15 0x55874c68c1e6 in vips_foreign_load_generate /src/libvips/build/../libvips/foreign/foreign.c:1066:6
    #16 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #17 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #18 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #19 0x55874c7e23d6 in vips_copy_gen /src/libvips/build/../libvips/conversion/copy.c:140:6
    #20 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #21 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #22 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #23 0x55874c7f424c in vips_cast_gen /src/libvips/build/../libvips/conversion/cast.c:369:6
    #24 0x55874c5efc16 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #25 0x55874c5ef98e in vips_region_fill /src/libvips/build/../libvips/iofuncs/region.c:881:7
    #26 0x55874c5ef98e in vips_region_prepare /src/libvips/build/../libvips/iofuncs/region.c:1692:7
    #27 0x55874c7e23d6 in vips_copy_gen /src/libvips/build/../libvips/conversion/copy.c:140:6
    #28 0x55874c5f08a6 in vips_region_generate /src/libvips/build/../libvips/iofuncs/region.c:1624:6
    #29 0x55874c5f08a6 in vips_region_prepare_to_generate /src/libvips/build/../libvips/iofuncs/region.c:1748:6
    #30 0x55874c5f03c1 in vips_region_prepare_to /src/libvips/build/../libvips/iofuncs/region.c:1865:7
    #31 0x55874c5cc772 in wbuffer_work_fn /src/libvips/build/../libvips/iofuncs/sinkdisc.c:431:11
    #32 0x55874c8c9c9e in vips_worker_work_unit /src/libvips/build/../libvips/iofuncs/threadpool.c:373:6
    #33 0x55874c8c9c9e in vips_thread_main_loop /src/libvips/build/../libvips/iofuncs/threadpool.c:400:3
    #34 0x55874c974d2c in vips_threadset_work /src/libvips/build/../libvips/iofuncs/threadset.c:182:3
    #35 0x55874c5b3f40 in vips_thread_run /src/libvips/build/../libvips/iofuncs/thread.c:148:11
    #36 0x55874c9a3550 in g_thread_proxy (/out/matrixsave_buffer_fuzzer+0xbc8550)

DEDUP_TOKEN: __interceptor_calloc--g_malloc0--rtiff_seq_start
Thread T4 (libvips worker) created by T0 here:
    #0 0x55874c559bd1 in pthread_create /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:250:3
    #1 0x55874c9c0bfa in g_system_thread_new (/out/matrixsave_buffer_fuzzer+0xbe5bfa)

DEDUP_TOKEN: ___interceptor_pthread_create--g_system_thread_new
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/libjpeg-turbo/src/jdmarker.c in next_marker
Shadow bytes around the buggy address:
  0x7fc8846b5580: [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m
  0x7fc8846b5600: [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m
  0x7fc8846b5680: [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m
  0x7fc8846b5700: [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m
  0x7fc8846b5780: [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m [1m[0m00[1m[0m
=>0x7fc8846b5800:[[1m[31mfa[1m[0m][1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x7fc8846b5880: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x7fc8846b5900: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x7fc8846b5980: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x7fc8846b5a00: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
  0x7fc8846b5a80: [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m [1m[31mfa[1m[0m
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           [1m[0m00[1m[0m
  Partially addressable: [1m[0m01[1m[0m [1m[0m02[1m[0m [1m[0m03[1m[0m [1m[0m04[1m[0m [1m[0m05[1m[0m [1m[0m06[1m[0m [1m[0m07[1m[0m 
  Heap left redzone:       [1m[31mfa[1m[0m
  Freed heap region:       [1m[35mfd[1m[0m
  Stack left redzone:      [1m[31mf1[1m[0m
  Stack mid redzone:       [1m[31mf2[1m[0m
  Stack right redzone:     [1m[31mf3[1m[0m
  Stack after return:      [1m[35mf5[1m[0m
  Stack use after scope:   [1m[35mf8[1m[0m
  Global redzone:          [1m[31mf9[1m[0m
  Global init order:       [1m[36mf6[1m[0m
  Poisoned by user:        [1m[34mf7[1m[0m
  Container overflow:      [1m[34mfc[1m[0m
  Array cookie:            [1m[31mac[1m[0m
  Intra object redzone:    [1m[33mbb[1m[0m
  ASan internal:           [1m[33mfe[1m[0m
  Left alloca redzone:     [1m[34mca[1m[0m
  Right alloca redzone:    [1m[34mcb[1m[0m
==14==ABORTING
