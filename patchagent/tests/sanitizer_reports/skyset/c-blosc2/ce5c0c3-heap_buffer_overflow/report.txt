=================================================================
==2799671==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x5210000025b4 at pc 0x7f75e2031af9 bp 0x7ffdcd6c3bf0 sp 0x7ffdcd6c33c0
WRITE of size 57344 at 0x5210000025b4 thread T0
    #0 0x7f75e2031af8 in __asan_memset build-llvm/tools/clang/stage2-bins/runtimes/runtimes-bins/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:67:3
    #1 0x55b560a44cc2 in ndlz4_decompress /root/plugins/codecs/ndlz/ndlz4x4.c:551:3
    #2 0x55b560a402a5 in ndlz_decompress /root/plugins/codecs/ndlz/ndlz.c:50:14
    #3 0x55b56058aa0b in blosc_d /root/blosc/blosc2.c:1867:24
    #4 0x55b560595ecd in serial_blosc /root/blosc/blosc2.c:1968:16
    #5 0x55b56059517d in do_job /root/blosc/blosc2.c:2135:15
    #6 0x55b56058375c in blosc_run_decompression_with_context /root/blosc/blosc2.c:2917:13
    #7 0x55b560583b52 in blosc2_decompress /root/blosc/blosc2.c:2995:12
    #8 0x55b56056fe97 in LLVMFuzzerTestOneInput /root/tests/fuzz/fuzz_decompress_chunk.c:34:5
    #9 0x55b5605701d6 in main /root/tests/fuzz/standalone.c:33:7
    #10 0x7f75e1c361c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #11 0x7f75e1c3628a in __libc_start_main csu/../csu/libc-start.c:360:3
    #12 0x55b56056e844 in _start (/root/tests/fuzz/decompress_chunk_fuzzer+0x16844) (BuildId: 13afb103f3da476b0a4b260fedcd31440147ca8b)

0x5210000025b4 is located 0 bytes after 4276-byte region [0x521000001500,0x5210000025b4)
allocated by thread T0 here:
    #0 0x7f75e20344fb in posix_memalign build-llvm/tools/clang/stage2-bins/runtimes/runtimes-bins/compiler-rt/lib/asan/asan_malloc_linux.cpp:142:3
    #1 0x55b5605877b0 in my_malloc /root/blosc/blosc2.c:188:9
    #2 0x55b56058c5c4 in init_thread_context /root/blosc/blosc2.c:2025:25
    #3 0x55b56058c3c7 in create_thread_context /root/blosc/blosc2.c:2062:12
    #4 0x55b560594e76 in do_job /root/blosc/blosc2.c:2128:33
    #5 0x55b56058375c in blosc_run_decompression_with_context /root/blosc/blosc2.c:2917:13
    #6 0x55b560583b52 in blosc2_decompress /root/blosc/blosc2.c:2995:12
    #7 0x55b56056fe97 in LLVMFuzzerTestOneInput /root/tests/fuzz/fuzz_decompress_chunk.c:34:5
    #8 0x55b5605701d6 in main /root/tests/fuzz/standalone.c:33:7
    #9 0x7f75e1c361c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #10 0x7f75e1c3628a in __libc_start_main csu/../csu/libc-start.c:360:3
    #11 0x55b56056e844 in _start (/root/tests/fuzz/decompress_chunk_fuzzer+0x16844) (BuildId: 13afb103f3da476b0a4b260fedcd31440147ca8b)

SUMMARY: AddressSanitizer: heap-buffer-overflow /root/plugins/codecs/ndlz/ndlz4x4.c:551:3 in ndlz4_decompress
Shadow bytes around the buggy address:
  0x521000002300: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x521000002380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x521000002400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x521000002480: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x521000002500: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x521000002580: 00 00 00 00 00 00[04]fa fa fa fa fa fa fa fa fa
  0x521000002600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x521000002680: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x521000002700: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x521000002780: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x521000002800: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==2799671==ABORTING
