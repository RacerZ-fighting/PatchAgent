+ FUZZER=HamcrestFuzzer
+ shift
+ '[' '!' -v TESTCASE ']'
+ TESTCASE=/testcase
+ '[' '!' -f /testcase ']'
+ export RUN_FUZZER_MODE=interactive
+ RUN_FUZZER_MODE=interactive
+ export FUZZING_ENGINE=libfuzzer
+ FUZZING_ENGINE=libfuzzer
+ export SKIP_SEED_CORPUS=1
+ SKIP_SEED_CORPUS=1
+ run_fuzzer HamcrestFuzzer -runs=100 /testcase
vm.mmap_rnd_bits = 28
/out/HamcrestFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null
OpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.
OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
INFO: Loaded 265 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks
INFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks
INFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks
INFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks
INFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks
INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization
INFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection
INFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection
INFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup
INFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection
INFO: Loaded 48 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall
INFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection
INFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks
INFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection
INFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery
INFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection
INFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection
INFO: Instrumented HamcrestFuzzer (took 30 ms, size +8%)
INFO: Instrumented org.w3c.dom.DOMException (took 1 ms, size +8%)
INFO: Instrumented org.w3c.dom.Node (took 1 ms, size +0%)
INFO: using inputs from: /testcase
INFO: found LLVMFuzzerCustomMutator (0x7fd235311a00). Disabling -len_control by default.
INFO: libFuzzer ignores flags that start with '--'
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 1267099339
INFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x555c23967b20, 0x555c23967d20), 
INFO: Loaded 1 PC tables (512 PCs): 512 [0x555c23933d40,0x555c23935d40), 
jazzer: Running 1 inputs 100 time(s) each.
Running: /testcase
INFO: Instrumented org.hamcrest.Matchers (took 24 ms, size +3%)
INFO: Instrumented org.hamcrest.core.StringContains (took 1 ms, size +41%)
INFO: Instrumented org.hamcrest.core.SubstringMatcher (took 1 ms, size +17%)
INFO: Instrumented org.hamcrest.TypeSafeMatcher (took 1 ms, size +17%)
INFO: Instrumented org.hamcrest.BaseMatcher (took 1 ms, size +8%)
INFO: Instrumented org.hamcrest.Matcher (took 0 ms, size +0%)
INFO: Instrumented org.hamcrest.SelfDescribing (took 0 ms, size +0%)
INFO: Instrumented org.hamcrest.internal.ReflectiveTypeFinder (took 1 ms, size +40%)
INFO: Instrumented org.hamcrest.Description (took 0 ms, size +7%)
INFO: Instrumented org.hamcrest.MatcherAssert (took 1 ms, size +17%)
INFO: Instrumented org.hamcrest.StringDescription (took 1 ms, size +9%)
INFO: Instrumented org.hamcrest.BaseDescription (took 3 ms, size +13%)
INFO: Instrumented org.hamcrest.core.StringStartsWith (took 1 ms, size +40%)
INFO: Instrumented org.hamcrest.core.AllOf (took 1 ms, size +11%)
INFO: Instrumented org.hamcrest.DiagnosingMatcher (took 0 ms, size +11%)
INFO: Instrumented org.hamcrest.Description$NullDescription (took 1 ms, size +6%)
INFO: Instrumented org.hamcrest.core.Is (took 1 ms, size +6%)
INFO: Instrumented org.hamcrest.core.IsEqual (took 1 ms, size +35%)
INFO: Instrumented org.hamcrest.collection.IsMapWithSize (took 1 ms, size +6%)
INFO: Instrumented org.hamcrest.FeatureMatcher (took 1 ms, size +12%)
INFO: Instrumented org.hamcrest.TypeSafeDiagnosingMatcher (took 1 ms, size +16%)
INFO: Instrumented org.hamcrest.collection.IsCollectionWithSize (took 0 ms, size +6%)
INFO: Instrumented HamcrestFuzzer$1 (took 0 ms, size +10%)
INFO: New number of coverage counters: 1024
INFO: Instrumented org.hamcrest.collection.IsEmptyCollection (took 1 ms, size +6%)
INFO: Instrumented HamcrestFuzzer$2 (took 0 ms, size +10%)
INFO: Instrumented HamcrestFuzzer$3 (took 0 ms, size +10%)
INFO: Instrumented org.hamcrest.collection.IsEmptyIterable (took 1 ms, size +11%)
INFO: Instrumented org.hamcrest.internal.SelfDescribingValueIterator (took 0 ms, size +9%)
INFO: Instrumented org.hamcrest.internal.SelfDescribingValue (took 0 ms, size +10%)
INFO: Instrumented HamcrestFuzzer$4 (took 0 ms, size +10%)
INFO: Instrumented org.hamcrest.collection.IsIterableContainingInOrder (took 1 ms, size +7%)
INFO: Instrumented org.hamcrest.internal.NullSafety (took 0 ms, size +19%)
INFO: Instrumented org.hamcrest.collection.IsIterableContainingInOrder$MatchSeries (took 1 ms, size +12%)
INFO: Instrumented org.hamcrest.collection.IsIterableContainingInAnyOrder (took 1 ms, size +9%)
INFO: Instrumented org.hamcrest.collection.IsIterableContainingInAnyOrder$Matching (took 1 ms, size +13%)
INFO: Instrumented org.hamcrest.collection.IsMapContaining (took 1 ms, size +8%)
INFO: Instrumented org.hamcrest.core.IsAnything (took 0 ms, size +9%)
INFO: Instrumented org.hamcrest.collection.IsIn (took 1 ms, size +6%)
INFO: Instrumented org.hamcrest.number.IsCloseTo (took 1 ms, size +9%)
INFO: Instrumented org.hamcrest.number.IsNaN (took 1 ms, size +9%)
INFO: Instrumented org.hamcrest.number.OrderingComparison (took 0 ms, size +10%)
INFO: Instrumented org.hamcrest.comparator.ComparatorMatcherBuilder (took 0 ms, size +6%)
INFO: Instrumented org.hamcrest.comparator.ComparatorMatcherBuilder$1 (took 0 ms, size +10%)
INFO: Instrumented org.hamcrest.comparator.ComparatorMatcherBuilder$ComparatorMatcher (took 1 ms, size +13%)
INFO: Instrumented org.hamcrest.text.IsEqualIgnoringCase (took 1 ms, size +27%)
INFO: Instrumented org.hamcrest.text.IsEmptyString (took 1 ms, size +33%)
INFO: Instrumented org.hamcrest.core.IsNull (took 0 ms, size +9%)
INFO: Instrumented org.hamcrest.core.AnyOf (took 0 ms, size +6%)
INFO: Instrumented org.hamcrest.core.ShortcutCombination (took 0 ms, size +16%)
INFO: Instrumented org.hamcrest.text.IsBlankString (took 0 ms, size +20%)
INFO: Instrumented org.hamcrest.text.MatchesPattern (took 0 ms, size +18%)
INFO: Instrumented org.hamcrest.text.StringContainsInOrder (took 1 ms, size +26%)
INFO: Instrumented org.hamcrest.text.CharSequenceLength (took 0 ms, size +7%)
INFO: Instrumented org.hamcrest.CoreMatchers (took 2 ms, size +4%)
INFO: Instrumented org.hamcrest.object.HasToString (took 0 ms, size +7%)
INFO: Instrumented org.hamcrest.object.IsCompatibleType (took 0 ms, size +6%)
INFO: Instrumented org.w3c.dom.traversal.DocumentTraversal (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.events.DocumentEvent (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.ranges.DocumentRange (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.Document (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.NodeList (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.events.EventTarget (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.DocumentType (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.Element (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.ElementTraversal (took 0 ms, size +0%)
INFO: Instrumented org.w3c.dom.TypeInfo (took 0 ms, size +0%)
INFO: Instrumented org.hamcrest.xml.HasXPath (took 1 ms, size +8%)
INFO: Instrumented org.hamcrest.Condition$Step (took 0 ms, size +0%)
INFO: Instrumented org.hamcrest.xml.HasXPath$1 (took 0 ms, size +9%)
INFO: Instrumented org.hamcrest.Condition (took 0 ms, size +6%)
INFO: Instrumented org.xml.sax.ErrorHandler (took 0 ms, size +0%)

== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: XPath Injection
Injected query: ?=
	at com.code_intelligence.jazzer.sanitizers.XPathInjection.checkXpathExecute(XPathInjection.kt:68)
	at org.hamcrest.xml.HasXPath.compiledXPath(HasXPath.java:107)
	at org.hamcrest.xml.HasXPath.<init>(HasXPath.java:58)
	at org.hamcrest.xml.HasXPath.hasXPath(HasXPath.java:145)
	at org.hamcrest.xml.HasXPath.hasXPath(HasXPath.java:126)
	at org.hamcrest.Matchers.hasXPath(Matchers.java:2142)
	at HamcrestFuzzer.runTest(HamcrestFuzzer.java:283)
	at HamcrestFuzzer.fuzzerTestOneInput(HamcrestFuzzer.java:292)
Caused by: javax.xml.xpath.XPathExpressionException: javax.xml.transform.TransformerException: A location path was expected, but the end of the XPath expression was found instead.
	at java.xml/com.sun.org.apache.xpath.internal.jaxp.XPathImpl.compile(XPathImpl.java:170)
	at java.base/java.lang.invoke.MethodHandle.invokeWithArguments(MethodHandle.java:732)
	at com.code_intelligence.jazzer.sanitizers.XPathInjection.checkXpathExecute(XPathInjection.kt:58)
	... 7 more
Caused by: javax.xml.transform.TransformerException: A location path was expected, but the end of the XPath expression was found instead.
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.error(XPathParser.java:621)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.LocationPath(XPathParser.java:1558)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.PathExpr(XPathParser.java:1283)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.UnionExpr(XPathParser.java:1202)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.UnaryExpr(XPathParser.java:1108)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.MultiplicativeExpr(XPathParser.java:1029)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.AdditiveExpr(XPathParser.java:971)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.RelationalExpr(XPathParser.java:896)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.EqualityExpr(XPathParser.java:836)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.EqualityExpr(XPathParser.java:860)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.AndExpr(XPathParser.java:800)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.OrExpr(XPathParser.java:773)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.Expr(XPathParser.java:756)
	at java.xml/com.sun.org.apache.xpath.internal.compiler.XPathParser.initXPath(XPathParser.java:132)
	at java.xml/com.sun.org.apache.xpath.internal.XPath.<init>(XPath.java:178)
	at java.xml/com.sun.org.apache.xpath.internal.XPath.<init>(XPath.java:268)
	at java.xml/com.sun.org.apache.xpath.internal.jaxp.XPathImpl.compile(XPathImpl.java:162)
	... 9 more
DEDUP_TOKEN: 27972743a3f2d706
== libFuzzer crashing input ==
reproducer_path='.'; Java reproducer written to ./Crash_0586a2e68013514d5ad967371b7b1151fe4e4626.java

