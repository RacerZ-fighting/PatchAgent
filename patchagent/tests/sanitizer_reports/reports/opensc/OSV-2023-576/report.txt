INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /mnt/data0/zf1025/AICC/oss-fuzz/build/out/opensc:/out -v /mnt/data0/zf1025/AICC/oss-patch-build/opensc/OSV-2023-576/poc.bin:/testcase -t gcr.io/oss-fuzz-base/base-runner reproduce fuzz_pkcs15_decode -runs=100.
+ FUZZER=fuzz_pkcs15_decode
+ shift
+ '[' '!' -v TESTCASE ']'
+ TESTCASE=/testcase
+ '[' '!' -f /testcase ']'
+ export RUN_FUZZER_MODE=interactive
+ RUN_FUZZER_MODE=interactive
+ export FUZZING_ENGINE=libfuzzer
+ FUZZING_ENGINE=libfuzzer
+ export SKIP_SEED_CORPUS=1
+ SKIP_SEED_CORPUS=1
+ run_fuzzer fuzz_pkcs15_decode -runs=100 /testcase
vm.mmap_rnd_bits = 28
/out/fuzz_pkcs15_decode -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 616290253
INFO: Loaded 1 modules   (42053 inline 8-bit counters): 42053 [0x561100b53e30, 0x561100b5e275), 
INFO: Loaded 1 PC tables (42053 PCs): 42053 [0x561100b5e278,0x561100c026c8), 
/out/fuzz_pkcs15_decode: Running 1 inputs 100 time(s) each.
Running: /testcase
=================================================================
[1m[31m==15==ERROR: AddressSanitizer: attempting double-free on 0x506000000080 in thread T0:
[1m[0mSCARINESS: 42 (double-free)
    #0 0x5611003887c6 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x561100405aa2 in sc_pkcs15_free_object_content /src/opensc/src/libopensc/pkcs15.c:2731:4
    #2 0x5611004056ec in sc_pkcs15_free_object /src/opensc/src/libopensc/pkcs15.c:1996:2
    #3 0x5611003c66ac in LLVMFuzzerTestOneInput /src/opensc/src/tests/fuzzing/fuzz_pkcs15_decode.c:93:3
    #4 0x56110027cc90 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #5 0x561100267f05 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #6 0x56110026d99f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #7 0x561100298c42 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #8 0x7fa7e96d0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0323ab4806bee6f846d9ad4bccfc29afdca49a58)
    #9 0x5611002600ed in _start (/out/fuzz_pkcs15_decode+0x1f30ed)

DEDUP_TOKEN: __interceptor_free--sc_pkcs15_free_object_content--sc_pkcs15_free_object
[1m[32m0x506000000080 is located 0 bytes inside of 49-byte region [0x506000000080,0x5060000000b1)
[1m[0m[1m[35mfreed by thread T0 here:[1m[0m
    #0 0x5611003887c6 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x56110042ff7f in sc_pkcs15_decode_pukdf_entry /src/opensc/src/libopensc/pkcs15-pubkey.c:355:4
    #2 0x5611003c661d in LLVMFuzzerTestOneInput /src/opensc/src/tests/fuzzing/fuzz_pkcs15_decode.c:88:24
    #3 0x56110027cc90 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #4 0x561100267f05 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #5 0x56110026d99f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #6 0x561100298c42 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #7 0x7fa7e96d0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0323ab4806bee6f846d9ad4bccfc29afdca49a58)

DEDUP_TOKEN: __interceptor_free--sc_pkcs15_decode_pukdf_entry--LLVMFuzzerTestOneInput
[1m[35mpreviously allocated by thread T0 here:[1m[0m
    #0 0x561100388a5f in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x561100912a65 in asn1_decode_entry /src/opensc/src/libopensc/asn1.c:1579:13
    #2 0x56110090bb2a in asn1_decode /src/opensc/src/libopensc/asn1.c:1783:7
    #3 0x56110090b4af in asn1_decode /src/opensc/src/libopensc/asn1.c:1753:8
    #4 0x561100911ef6 in asn1_decode_entry /src/opensc/src/libopensc/asn1.c:1507:8
    #5 0x56110090bb2a in asn1_decode /src/opensc/src/libopensc/asn1.c:1783:7
    #6 0x561100911ef6 in asn1_decode_entry /src/opensc/src/libopensc/asn1.c:1507:8
    #7 0x56110090bb2a in asn1_decode /src/opensc/src/libopensc/asn1.c:1783:7
    #8 0x5611009153f3 in asn1_decode_p15_object /src/opensc/src/libopensc/asn1.c:1428:6
    #9 0x56110091379e in asn1_decode_entry /src/opensc/src/libopensc/asn1.c:1655:8
    #10 0x56110090bb2a in asn1_decode /src/opensc/src/libopensc/asn1.c:1783:7
    #11 0x56110090b4af in asn1_decode /src/opensc/src/libopensc/asn1.c:1753:8
    #12 0x56110090aa28 in sc_asn1_decode /src/opensc/src/libopensc/asn1.c:1805:9
    #13 0x56110042f014 in sc_pkcs15_decode_pukdf_entry /src/opensc/src/libopensc/pkcs15-pubkey.c:290:6
    #14 0x5611003c661d in LLVMFuzzerTestOneInput /src/opensc/src/tests/fuzzing/fuzz_pkcs15_decode.c:88:24
    #15 0x56110027cc90 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #16 0x561100267f05 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #17 0x56110026d99f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #18 0x561100298c42 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #19 0x7fa7e96d0082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0323ab4806bee6f846d9ad4bccfc29afdca49a58)

DEDUP_TOKEN: __interceptor_malloc--asn1_decode_entry--asn1_decode
SUMMARY: AddressSanitizer: double-free /src/opensc/src/libopensc/pkcs15.c:2731:4 in sc_pkcs15_free_object_content
==15==ABORTING
